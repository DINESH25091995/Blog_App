{% extends "base.html" %}
{% block content %}

<!-- Load CSS -->
<link rel="stylesheet" href="{{ url_for('static', path='css/styles.css') }}">
<link rel="stylesheet" href="{{ url_for('static', path='css/styles_shop_details.css') }}">

<!-- Sidebar Toggle Button for Mobile -->
<button class="toggle-menu" onclick="toggleSidebar()">☰ Menu</button>

<div class="main-container">
    
    <!-- Sidebar -->
    <div class="sidebar">
        <button onclick="showSection('list_of_appointments')" class="nav-btn">📅 List of Appointments</button>
        <button onclick="showSection('book_appointment')" class="nav-btn">📅 Book Appointment</button>
        <button onclick="showSection('workers')" class="nav-btn">👷 List of Workers</button>
        <button onclick="showSection('services')" class="nav-btn">🛠️ List of Services</button>
        {% if current_user and current_user.id == shop.user_id %}
            <button onclick="showSection('add_workers')" class="nav-btn">👷 Add Workers</button>
            <button onclick="showSection('add_services')" class="nav-btn">🛠️ Add Services</button>
        {% endif %}
        <button onclick="showSection('shop_time')" class="nav-btn">📅 Shop Time</button>
    </div>

    <!-- Content -->
    <div class="content">
        <div id="list_of_appointments" class="section">
            {% include "list_of_appointment.html" %}
        </div>
        <div id="book_appointment" class="section">
            {% include "book_appointment.html" %}
        </div>
        <div id="workers" class="section">
            {% include "list_of_workers.html" %}
        </div>
        <div id="add_workers" class="section">
            {% include "add_workers.html" %}
        </div>
        <div id="services" class="section">
            {% include "list_of_services.html" %}
        </div>
        <div id="add_services" class="section">
            {% include "add_services.html" %}
        </div>
        <div id="shop_time" class="section">
            {% include "shop_time.html" %}
        </div>
    </div>
</div>

<!-- JavaScript for Sidebar & Section Handling -->
<script>
    function toggleSidebar() {
        document.querySelector('.sidebar').classList.toggle('open');
    }

    function showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });

        // Show the selected section
        document.getElementById(sectionId).classList.add('active');

        // Remove active class from all buttons
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.classList.remove('active-btn');
        });

        // Add active class to clicked button
        event.target.classList.add('active-btn');

        // Store the active section in localStorage
        localStorage.setItem('activeSection', sectionId);
    }

    // Restore last active section on page load
    document.addEventListener("DOMContentLoaded", function () {
        let activeSection = localStorage.getItem('activeSection') || 'list_of_appointments';
        showSection(activeSection);
    });

    // Close sidebar when clicking outside (for better mobile experience)
    document.addEventListener("click", function(event) {
        let sidebar = document.querySelector('.sidebar');
        let button = document.querySelector('.toggle-menu');
        
        if (!sidebar.contains(event.target) && !button.contains(event.target)) {
            sidebar.classList.remove('open');
        }
    });
</script>

{% endblock %}
